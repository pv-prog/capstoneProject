[2024-03-17 11:18:27,016] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2024-03-17 11:18:27,175] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 5281 due to node 1 being disconnected (elapsed time since creation: 241150ms, elapsed time since send: 241150ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2024-03-17 11:18:27,175] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 11:18:27,187] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, epoch=58, retries=1, voteStates={1=UNRECORDED, 2=UNRECORDED, 3=GRANTED}, highWatermark=Optional[LogOffsetMetadata(offset=47699, metadata=Optional.empty)], electionTimeoutMs=1441) from FollowerState(fetchTimeoutMs=2000, epoch=57, leaderId=1, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=47699, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2024-03-17 11:18:27,191] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=58, candidateId=2, lastOffsetEpoch=57, lastOffset=47700)])]) with epoch 58 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 11:18:27,365] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 11:18:27,499] INFO [RaftManager id=3] Completed transition to Unattached(epoch=59, voters=[1, 2, 3], electionTimeoutMs=1179) from CandidateState(localId=3, epoch=58, retries=1, voteStates={1=REJECTED, 2=REJECTED, 3=GRANTED}, highWatermark=Optional[LogOffsetMetadata(offset=47699, metadata=Optional.empty)], electionTimeoutMs=1441) (org.apache.kafka.raft.QuorumState)
[2024-03-17 11:18:27,528] INFO [RaftManager id=3] Completed transition to Voted(epoch=59, votedId=2, voters=[1, 2, 3], electionTimeoutMs=1166) from Unattached(epoch=59, voters=[1, 2, 3], electionTimeoutMs=1179) (org.apache.kafka.raft.QuorumState)
[2024-03-17 11:18:27,528] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=59, candidateId=2, lastOffsetEpoch=57, lastOffset=47700)])]) with epoch 59 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 11:18:27,571] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=59, leaderId=2, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=47699, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Voted(epoch=59, votedId=2, voters=[1, 2, 3], electionTimeoutMs=1166) (org.apache.kafka.raft.QuorumState)
[2024-03-17 11:18:28,029] INFO [BrokerToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 11:18:28,030] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 11:32:17,420] INFO [RaftManager id=3] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2024-03-17 11:32:17,421] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 5382 due to node 2 being disconnected (elapsed time since creation: 783655ms, elapsed time since send: 783655ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2024-03-17 11:32:17,421] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 11:32:17,438] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, epoch=60, retries=1, voteStates={1=UNRECORDED, 2=UNRECORDED, 3=GRANTED}, highWatermark=Optional[LogOffsetMetadata(offset=47791, metadata=Optional.empty)], electionTimeoutMs=1298) from FollowerState(fetchTimeoutMs=2000, epoch=59, leaderId=2, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=47791, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2024-03-17 11:32:17,447] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=60, candidateId=1, lastOffsetEpoch=59, lastOffset=47792)])]) with epoch 60 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 11:32:17,498] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 11:32:17,498] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 11:32:17,499] INFO [BrokerToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 11:32:17,503] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, epoch=61, retries=2, voteStates={1=UNRECORDED, 2=UNRECORDED, 3=GRANTED}, highWatermark=Optional[LogOffsetMetadata(offset=47791, metadata=Optional.empty)], electionTimeoutMs=1251) from CandidateState(localId=3, epoch=60, retries=1, voteStates={1=REJECTED, 2=REJECTED, 3=GRANTED}, highWatermark=Optional[LogOffsetMetadata(offset=47791, metadata=Optional.empty)], electionTimeoutMs=1298) (org.apache.kafka.raft.QuorumState)
[2024-03-17 11:32:17,540] INFO [RaftManager id=3] Completed transition to Leader(localId=3, epoch=61, epochStartOffset=47792, highWatermark=Optional.empty, voterStates={1=ReplicaState(nodeId=1, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(nodeId=2, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(nodeId=3, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, epoch=61, retries=2, voteStates={1=GRANTED, 2=REJECTED, 3=GRANTED}, highWatermark=Optional[LogOffsetMetadata(offset=47791, metadata=Optional.empty)], electionTimeoutMs=1251) (org.apache.kafka.raft.QuorumState)
[2024-03-17 11:32:17,592] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=47793, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=3358329)]) for the first time for epoch 61 based on indexOfHw 1 and voters [ReplicaState(nodeId=1, endOffset=Optional[LogOffsetMetadata(offset=47793, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=3358329)])], lastFetchTimestamp=1710655337592, lastCaughtUpTimestamp=1710655337592, hasAcknowledgedLeader=true), ReplicaState(nodeId=3, endOffset=Optional[LogOffsetMetadata(offset=47793, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=3358329)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(nodeId=2, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2024-03-17 11:32:17,600] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9097 (id: 3 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 11:42:17,677] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-03-17 11:42:17,678] INFO [RaftManager id=3] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-03-17 11:43:47,896] INFO [GroupCoordinator 3]: Preparing to rebalance group console-consumer-99230 in state PreparingRebalance with old generation 1 (__consumer_offsets-14) (reason: Removing member console-consumer-ed76e175-3157-4a56-8f9d-37f04cfbc504 on LeaveGroup; client reason: the consumer is being closed) (kafka.coordinator.group.GroupCoordinator)
[2024-03-17 11:43:47,896] INFO [GroupCoordinator 3]: Group console-consumer-99230 with generation 2 is now empty (__consumer_offsets-14) (kafka.coordinator.group.GroupCoordinator)
[2024-03-17 11:43:47,898] INFO [GroupCoordinator 3]: Member MemberMetadata(memberId=console-consumer-ed76e175-3157-4a56-8f9d-37f04cfbc504, groupInstanceId=None, clientId=console-consumer, clientHost=/127.0.0.1, sessionTimeoutMs=45000, rebalanceTimeoutMs=300000, supportedProtocols=List(range, cooperative-sticky)) has left group console-consumer-99230 through explicit `LeaveGroup`; client reason: the consumer is being closed (kafka.coordinator.group.GroupCoordinator)
[2024-03-17 11:45:04,966] INFO [GroupCoordinator 3]: Dynamic member with unknown member id joins group console-consumer-55939 in Empty state. Created a new member id console-consumer-db040df4-20a7-476d-a6cc-bd30cf2bdf50 and request the member to rejoin with this id. (kafka.coordinator.group.GroupCoordinator)
[2024-03-17 11:45:04,967] INFO [GroupCoordinator 3]: Preparing to rebalance group console-consumer-55939 in state PreparingRebalance with old generation 0 (__consumer_offsets-2) (reason: Adding new member console-consumer-db040df4-20a7-476d-a6cc-bd30cf2bdf50 with group instance id None; client reason: rebalance failed due to MemberIdRequiredException) (kafka.coordinator.group.GroupCoordinator)
[2024-03-17 11:45:07,971] INFO [GroupCoordinator 3]: Stabilized group console-consumer-55939 generation 1 (__consumer_offsets-2) with 1 members (kafka.coordinator.group.GroupCoordinator)
[2024-03-17 11:45:07,988] INFO [GroupCoordinator 3]: Assignment received from leader console-consumer-db040df4-20a7-476d-a6cc-bd30cf2bdf50 for group console-consumer-55939 for generation 1. The group has 1 members, 0 of which are static. (kafka.coordinator.group.GroupCoordinator)
[2024-03-17 11:47:24,692] INFO [SnapshotGenerator id=3] Creating new KRaft snapshot file snapshot 00000000000000049593-0000000061 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2024-03-17 11:47:24,713] INFO [SnapshotEmitter id=3] Successfully wrote snapshot 00000000000000049593-0000000061 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2024-03-17 11:47:25,368] INFO [GroupMetadataManager brokerId=3] Group console-consumer-99230 transitioned to Dead in generation 2 (kafka.coordinator.group.GroupMetadataManager)
