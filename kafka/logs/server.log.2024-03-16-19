[2024-03-16 21:06:35,846] INFO [SnapshotGenerator id=2] Creating new KRaft snapshot file snapshot 00000000000000041854-0000000050 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2024-03-16 21:06:35,909] INFO [SnapshotEmitter id=2] Successfully wrote snapshot 00000000000000041854-0000000050 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2024-03-16 21:09:23,014] INFO [RaftManager id=2] Completed transition to Unattached(epoch=51, voters=[1, 2, 3], electionTimeoutMs=1925) from FollowerState(fetchTimeoutMs=2000, epoch=50, leaderId=1, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=42089, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2024-03-16 21:09:23,016] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=51, candidateId=3, lastOffsetEpoch=50, lastOffset=42089)])]) with epoch 51 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-16 21:09:23,185] INFO [RaftManager id=2] Completed transition to Unattached(epoch=52, voters=[1, 2, 3], electionTimeoutMs=1746) from Unattached(epoch=51, voters=[1, 2, 3], electionTimeoutMs=1925) (org.apache.kafka.raft.QuorumState)
[2024-03-16 21:09:23,186] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=52, candidateId=3, lastOffsetEpoch=50, lastOffset=42089)])]) with epoch 52 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-16 21:09:23,203] INFO [RaftManager id=2] Completed transition to Unattached(epoch=53, voters=[1, 2, 3], electionTimeoutMs=1727) from Unattached(epoch=52, voters=[1, 2, 3], electionTimeoutMs=1746) (org.apache.kafka.raft.QuorumState)
[2024-03-16 21:09:23,204] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=53, candidateId=3, lastOffsetEpoch=50, lastOffset=42089)])]) with epoch 53 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-16 21:09:23,854] INFO [RaftManager id=2] Completed transition to Unattached(epoch=54, voters=[1, 2, 3], electionTimeoutMs=1081) from Unattached(epoch=53, voters=[1, 2, 3], electionTimeoutMs=1727) (org.apache.kafka.raft.QuorumState)
[2024-03-16 21:09:23,860] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=54, candidateId=3, lastOffsetEpoch=50, lastOffset=42089)])]) with epoch 54 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-16 21:09:24,064] INFO [RaftManager id=2] Completed transition to Unattached(epoch=55, voters=[1, 2, 3], electionTimeoutMs=865) from Unattached(epoch=54, voters=[1, 2, 3], electionTimeoutMs=1081) (org.apache.kafka.raft.QuorumState)
[2024-03-16 21:09:24,076] INFO [RaftManager id=2] Completed transition to Voted(epoch=55, votedId=1, voters=[1, 2, 3], electionTimeoutMs=1488) from Unattached(epoch=55, voters=[1, 2, 3], electionTimeoutMs=865) (org.apache.kafka.raft.QuorumState)
[2024-03-16 21:09:24,077] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=55, candidateId=1, lastOffsetEpoch=50, lastOffset=42090)])]) with epoch 55 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-16 21:09:24,129] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=55, leaderId=1, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=42089, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Voted(epoch=55, votedId=1, voters=[1, 2, 3], electionTimeoutMs=1488) (org.apache.kafka.raft.QuorumState)
[2024-03-16 21:15:10,182] INFO Terminating process due to signal SIGINT (org.apache.kafka.common.utils.LoggingSignalHandler)
[2024-03-16 21:15:10,186] INFO [BrokerServer id=2] Transition from STARTED to SHUTTING_DOWN (kafka.server.BrokerServer)
[2024-03-16 21:15:10,187] INFO [BrokerServer id=2] shutting down (kafka.server.BrokerServer)
[2024-03-16 21:15:10,189] INFO [BrokerLifecycleManager id=2] Beginning controlled shutdown. (kafka.server.BrokerLifecycleManager)
[2024-03-16 21:15:10,232] INFO [BrokerLifecycleManager id=2] The broker is in PENDING_CONTROLLED_SHUTDOWN state, still waiting for the active controller. (kafka.server.BrokerLifecycleManager)
[2024-03-16 21:15:10,289] INFO [BrokerLifecycleManager id=2] The broker is in PENDING_CONTROLLED_SHUTDOWN state, still waiting for the active controller. (kafka.server.BrokerLifecycleManager)
[2024-03-16 21:15:10,762] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions HashSet(product-created-events-topic-2, __consumer_offsets-9, __consumer_offsets-25, messages-order-1, __consumer_offsets-31, product-created-events-topic-0, __consumer_offsets-13, __consumer_offsets-6, __consumer_offsets-20, __consumer_offsets-29, __consumer_offsets-35, messages-order-2, __consumer_offsets-23, topic2-0, __consumer_offsets-42, product-created-events-topic-1, topic2-1, messages-order-0, __consumer_offsets-38, __consumer_offsets-17, __consumer_offsets-48, __consumer_offsets-45, __consumer_offsets-1, __consumer_offsets-5, topic2-2, __consumer_offsets-40) (kafka.server.ReplicaFetcherManager)
[2024-03-16 21:15:10,762] INFO [ReplicaAlterLogDirsManager on broker 2] Removed fetcher for partitions HashSet(product-created-events-topic-2, __consumer_offsets-9, __consumer_offsets-25, messages-order-1, __consumer_offsets-31, product-created-events-topic-0, __consumer_offsets-13, __consumer_offsets-6, __consumer_offsets-20, __consumer_offsets-29, __consumer_offsets-35, messages-order-2, __consumer_offsets-23, topic2-0, __consumer_offsets-42, product-created-events-topic-1, topic2-1, messages-order-0, __consumer_offsets-38, __consumer_offsets-17, __consumer_offsets-48, __consumer_offsets-45, __consumer_offsets-1, __consumer_offsets-5, topic2-2, __consumer_offsets-40) (kafka.server.ReplicaAlterLogDirsManager)
[2024-03-16 21:15:10,764] INFO [ReplicaFetcherThread-0-1]: Shutting down (kafka.server.ReplicaFetcherThread)
[2024-03-16 21:15:10,764] INFO [ReplicaFetcher replicaId=2, leaderId=1, fetcherId=0] Client requested connection close from node 1 (org.apache.kafka.clients.NetworkClient)
[2024-03-16 21:15:10,767] INFO [ReplicaFetcher replicaId=2, leaderId=1, fetcherId=0] Cancelled in-flight FETCH request with correlation id 7425 due to node 1 being disconnected (elapsed time since creation: 57ms, elapsed time since send: 57ms, request timeout: 30000ms) (org.apache.kafka.clients.NetworkClient)
[2024-03-16 21:15:10,767] INFO [ReplicaFetcher replicaId=2, leaderId=1, fetcherId=0] Error sending fetch request (sessionId=1818108773, epoch=7409) to node 1: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Client was shutdown before response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:108)
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:113)
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:79)
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:316)
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:130)
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:129)
	at scala.Option.foreach(Option.scala:437)
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:129)
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:112)
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:98)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:130)
[2024-03-16 21:15:10,769] INFO [ReplicaFetcherThread-0-1]: Stopped (kafka.server.ReplicaFetcherThread)
[2024-03-16 21:15:10,769] INFO [ReplicaFetcherThread-0-1]: Shutdown completed (kafka.server.ReplicaFetcherThread)
[2024-03-16 21:15:10,771] INFO [ReplicaFetcherThread-0-3]: Shutting down (kafka.server.ReplicaFetcherThread)
[2024-03-16 21:15:10,771] INFO [ReplicaFetcher replicaId=2, leaderId=3, fetcherId=0] Client requested connection close from node 3 (org.apache.kafka.clients.NetworkClient)
[2024-03-16 21:15:10,771] INFO [ReplicaFetcher replicaId=2, leaderId=3, fetcherId=0] Cancelled in-flight FETCH request with correlation id 7007 due to node 3 being disconnected (elapsed time since creation: 375ms, elapsed time since send: 375ms, request timeout: 30000ms) (org.apache.kafka.clients.NetworkClient)
[2024-03-16 21:15:10,771] INFO [ReplicaFetcher replicaId=2, leaderId=3, fetcherId=0] Error sending fetch request (sessionId=2051659466, epoch=7007) to node 3: (org.apache.kafka.clients.FetchSessionHandler)
java.io.IOException: Client was shutdown before response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:108)
	at kafka.server.BrokerBlockingSender.sendRequest(BrokerBlockingSender.scala:113)
	at kafka.server.RemoteLeaderEndPoint.fetch(RemoteLeaderEndPoint.scala:79)
	at kafka.server.AbstractFetcherThread.processFetchRequest(AbstractFetcherThread.scala:316)
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3(AbstractFetcherThread.scala:130)
	at kafka.server.AbstractFetcherThread.$anonfun$maybeFetch$3$adapted(AbstractFetcherThread.scala:129)
	at scala.Option.foreach(Option.scala:437)
	at kafka.server.AbstractFetcherThread.maybeFetch(AbstractFetcherThread.scala:129)
	at kafka.server.AbstractFetcherThread.doWork(AbstractFetcherThread.scala:112)
	at kafka.server.ReplicaFetcherThread.doWork(ReplicaFetcherThread.scala:98)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:130)
[2024-03-16 21:15:10,771] INFO [ReplicaFetcherThread-0-3]: Stopped (kafka.server.ReplicaFetcherThread)
[2024-03-16 21:15:10,771] INFO [ReplicaFetcherThread-0-3]: Shutdown completed (kafka.server.ReplicaFetcherThread)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 48 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-48 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 13 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-13 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 45 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-45 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 9 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-48 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-9 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-13 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 42 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-42 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-45 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 23 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-9 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-23 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-42 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 20 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-20 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-23 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 17 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-17 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 31 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-31 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-20 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 29 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-29 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-17 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 25 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-25 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-31 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 40 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-40 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-29 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 5 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-25 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,772] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-5 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,773] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-40 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,773] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 6 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,773] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-6 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,773] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-5 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,773] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 38 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,773] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-6 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,773] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-38 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,773] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 35 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,773] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-35 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,773] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-38 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,773] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 1 in epoch OptionalInt[3] (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:10,773] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-35 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,773] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-1 (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:10,773] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-1 for coordinator epoch OptionalInt[3]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2024-03-16 21:15:12,335] INFO [BrokerLifecycleManager id=2] The controller has asked us to exit controlled shutdown. (kafka.server.BrokerLifecycleManager)
[2024-03-16 21:15:12,335] INFO [BrokerLifecycleManager id=2] beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2024-03-16 21:15:12,341] INFO [BrokerLifecycleManager id=2] Transitioning from PENDING_CONTROLLED_SHUTDOWN to SHUTTING_DOWN. (kafka.server.BrokerLifecycleManager)
[2024-03-16 21:15:12,341] INFO [broker-2-to-controller-heartbeat-channel-manager]: Shutting down (kafka.server.BrokerToControllerRequestThread)
[2024-03-16 21:15:12,341] INFO [broker-2-to-controller-heartbeat-channel-manager]: Stopped (kafka.server.BrokerToControllerRequestThread)
[2024-03-16 21:15:12,341] INFO [broker-2-to-controller-heartbeat-channel-manager]: Shutdown completed (kafka.server.BrokerToControllerRequestThread)
[2024-03-16 21:15:12,342] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions HashSet(product-created-events-topic-2, messages-order-2, topic2-0, messages-order-1, product-created-events-topic-1, product-created-events-topic-0, topic2-2, topic2-1, messages-order-0) (kafka.server.ReplicaFetcherManager)
[2024-03-16 21:15:12,342] INFO [ReplicaAlterLogDirsManager on broker 2] Removed fetcher for partitions HashSet(product-created-events-topic-2, messages-order-2, topic2-0, messages-order-1, product-created-events-topic-1, product-created-events-topic-0, topic2-2, topic2-1, messages-order-0) (kafka.server.ReplicaAlterLogDirsManager)
[2024-03-16 21:15:12,342] INFO [SocketServer listenerType=BROKER, nodeId=2] Stopping socket server request processors (kafka.network.SocketServer)
[2024-03-16 21:15:12,344] INFO Broker to controller channel manager for heartbeat shutdown (kafka.server.BrokerToControllerChannelManagerImpl)
[2024-03-16 21:15:12,346] INFO [SocketServer listenerType=BROKER, nodeId=2] Stopped socket server request processors (kafka.network.SocketServer)
[2024-03-16 21:15:12,346] INFO [data-plane Kafka Request Handler on Broker 2], shutting down (kafka.server.KafkaRequestHandlerPool)
[2024-03-16 21:15:12,351] INFO [data-plane Kafka Request Handler on Broker 2], shut down completely (kafka.server.KafkaRequestHandlerPool)
[2024-03-16 21:15:12,351] INFO [ExpirationReaper-2-AlterAcls]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,351] INFO [ExpirationReaper-2-AlterAcls]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,351] INFO [ExpirationReaper-2-AlterAcls]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,351] INFO [KafkaApi-2] Shutdown complete. (kafka.server.KafkaApis)
[2024-03-16 21:15:12,352] INFO [TransactionCoordinator id=2] Shutting down. (kafka.coordinator.transaction.TransactionCoordinator)
[2024-03-16 21:15:12,352] INFO [Transaction State Manager 2]: Shutdown complete (kafka.coordinator.transaction.TransactionStateManager)
[2024-03-16 21:15:12,353] INFO [TxnMarkerSenderThread-2]: Shutting down (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2024-03-16 21:15:12,353] INFO [TxnMarkerSenderThread-2]: Stopped (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2024-03-16 21:15:12,353] INFO [TxnMarkerSenderThread-2]: Shutdown completed (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2024-03-16 21:15:12,354] INFO [TransactionCoordinator id=2] Shutdown complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2024-03-16 21:15:12,356] INFO [GroupCoordinator 2]: Shutting down. (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:12,356] INFO [ExpirationReaper-2-Heartbeat]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,357] INFO [ExpirationReaper-2-Heartbeat]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,357] INFO [ExpirationReaper-2-Heartbeat]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,357] INFO [ExpirationReaper-2-Rebalance]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,357] INFO [ExpirationReaper-2-Rebalance]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,357] INFO [ExpirationReaper-2-Rebalance]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,357] INFO [GroupCoordinator 2]: Shutdown complete. (kafka.coordinator.group.GroupCoordinator)
[2024-03-16 21:15:12,357] INFO [ReplicaManager broker=2] Shutting down (kafka.server.ReplicaManager)
[2024-03-16 21:15:12,357] INFO [LogDirFailureHandler]: Shutting down (kafka.server.ReplicaManager$LogDirFailureHandler)
[2024-03-16 21:15:12,357] INFO [LogDirFailureHandler]: Stopped (kafka.server.ReplicaManager$LogDirFailureHandler)
[2024-03-16 21:15:12,357] INFO [LogDirFailureHandler]: Shutdown completed (kafka.server.ReplicaManager$LogDirFailureHandler)
[2024-03-16 21:15:12,358] INFO [ReplicaFetcherManager on broker 2] shutting down (kafka.server.ReplicaFetcherManager)
[2024-03-16 21:15:12,358] INFO [ReplicaFetcherManager on broker 2] shutdown completed (kafka.server.ReplicaFetcherManager)
[2024-03-16 21:15:12,358] INFO [ReplicaAlterLogDirsManager on broker 2] shutting down (kafka.server.ReplicaAlterLogDirsManager)
[2024-03-16 21:15:12,358] INFO [ReplicaAlterLogDirsManager on broker 2] shutdown completed (kafka.server.ReplicaAlterLogDirsManager)
[2024-03-16 21:15:12,358] INFO [ExpirationReaper-2-Fetch]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,358] INFO [ExpirationReaper-2-Fetch]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,358] INFO [ExpirationReaper-2-Fetch]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,358] INFO [ExpirationReaper-2-RemoteFetch]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,358] INFO [ExpirationReaper-2-RemoteFetch]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,358] INFO [ExpirationReaper-2-RemoteFetch]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,359] INFO [ExpirationReaper-2-Produce]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,362] INFO [ExpirationReaper-2-Produce]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,362] INFO [ExpirationReaper-2-Produce]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,362] INFO [ExpirationReaper-2-DeleteRecords]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,362] INFO [ExpirationReaper-2-DeleteRecords]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,362] INFO [ExpirationReaper-2-DeleteRecords]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,362] INFO [ExpirationReaper-2-ElectLeader]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,363] INFO [ExpirationReaper-2-ElectLeader]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,363] INFO [ExpirationReaper-2-ElectLeader]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,366] INFO [AddPartitionsToTxnSenderThread-2]: Shutting down (kafka.server.AddPartitionsToTxnManager)
[2024-03-16 21:15:12,366] INFO [AddPartitionsToTxnSenderThread-2]: Stopped (kafka.server.AddPartitionsToTxnManager)
[2024-03-16 21:15:12,366] INFO [AddPartitionsToTxnSenderThread-2]: Shutdown completed (kafka.server.AddPartitionsToTxnManager)
[2024-03-16 21:15:12,366] INFO [ReplicaManager broker=2] Shut down completely (kafka.server.ReplicaManager)
[2024-03-16 21:15:12,367] INFO [broker-2-to-controller-alter-partition-channel-manager]: Shutting down (kafka.server.BrokerToControllerRequestThread)
[2024-03-16 21:15:12,367] INFO [broker-2-to-controller-alter-partition-channel-manager]: Stopped (kafka.server.BrokerToControllerRequestThread)
[2024-03-16 21:15:12,367] INFO [broker-2-to-controller-alter-partition-channel-manager]: Shutdown completed (kafka.server.BrokerToControllerRequestThread)
[2024-03-16 21:15:12,367] INFO Broker to controller channel manager for alter-partition shutdown (kafka.server.BrokerToControllerChannelManagerImpl)
[2024-03-16 21:15:12,367] INFO [broker-2-to-controller-forwarding-channel-manager]: Shutting down (kafka.server.BrokerToControllerRequestThread)
[2024-03-16 21:15:12,367] INFO [broker-2-to-controller-forwarding-channel-manager]: Stopped (kafka.server.BrokerToControllerRequestThread)
[2024-03-16 21:15:12,367] INFO [broker-2-to-controller-forwarding-channel-manager]: Shutdown completed (kafka.server.BrokerToControllerRequestThread)
[2024-03-16 21:15:12,367] INFO Broker to controller channel manager for forwarding shutdown (kafka.server.BrokerToControllerChannelManagerImpl)
[2024-03-16 21:15:12,367] INFO Shutting down. (kafka.log.LogManager)
[2024-03-16 21:15:12,369] INFO [kafka-log-cleaner-thread-0]: Shutting down (kafka.log.LogCleaner$CleanerThread)
[2024-03-16 21:15:12,369] INFO [kafka-log-cleaner-thread-0]: Stopped (kafka.log.LogCleaner$CleanerThread)
[2024-03-16 21:15:12,369] INFO [kafka-log-cleaner-thread-0]: Shutdown completed (kafka.log.LogCleaner$CleanerThread)
[2024-03-16 21:15:12,402] INFO [ProducerStateManager partition=topic2-0]Wrote producer snapshot at offset 1 with 1 producer ids in 3 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2024-03-16 21:15:12,666] INFO Shutdown complete. (kafka.log.LogManager)
[2024-03-16 21:15:12,667] INFO [broker-2-ThrottledChannelReaper-Fetch]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-Fetch]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-Fetch]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-Produce]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-Produce]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-Produce]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-Request]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-Request]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-Request]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-ControllerMutation]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-ControllerMutation]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,668] INFO [broker-2-ThrottledChannelReaper-ControllerMutation]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,669] INFO [SocketServer listenerType=BROKER, nodeId=2] Shutting down socket server (kafka.network.SocketServer)
[2024-03-16 21:15:12,675] INFO [SocketServer listenerType=BROKER, nodeId=2] Shutdown completed (kafka.network.SocketServer)
[2024-03-16 21:15:12,676] INFO Broker and topic stats closed (kafka.server.BrokerTopicStats)
[2024-03-16 21:15:12,676] INFO [BrokerLifecycleManager id=2] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2024-03-16 21:15:12,676] INFO [BrokerServer id=2] shut down completed (kafka.server.BrokerServer)
[2024-03-16 21:15:12,676] INFO [BrokerServer id=2] Transition from SHUTTING_DOWN to SHUTDOWN (kafka.server.BrokerServer)
[2024-03-16 21:15:12,676] INFO [ControllerServer id=2] shutting down (kafka.server.ControllerServer)
[2024-03-16 21:15:12,676] INFO [raft-expiration-reaper]: Shutting down (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2024-03-16 21:15:12,877] INFO [raft-expiration-reaper]: Stopped (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2024-03-16 21:15:12,877] INFO [raft-expiration-reaper]: Shutdown completed (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2024-03-16 21:15:12,879] INFO [kafka-2-raft-io-thread]: Shutting down (kafka.raft.KafkaRaftManager$RaftIoThread)
[2024-03-16 21:15:12,880] INFO [RaftManager id=2] Beginning graceful shutdown (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-16 21:15:12,883] INFO [RaftManager id=2] Graceful shutdown completed (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-16 21:15:12,883] INFO [kafka-2-raft-io-thread]: Completed graceful shutdown of RaftClient (kafka.raft.KafkaRaftManager$RaftIoThread)
[2024-03-16 21:15:12,883] INFO [kafka-2-raft-io-thread]: Stopped (kafka.raft.KafkaRaftManager$RaftIoThread)
[2024-03-16 21:15:12,883] INFO [kafka-2-raft-io-thread]: Shutdown completed (kafka.raft.KafkaRaftManager$RaftIoThread)
[2024-03-16 21:15:12,890] INFO [kafka-2-raft-outbound-request-thread]: Shutting down (kafka.raft.RaftSendThread)
[2024-03-16 21:15:12,891] INFO [kafka-2-raft-outbound-request-thread]: Stopped (kafka.raft.RaftSendThread)
[2024-03-16 21:15:12,891] INFO [kafka-2-raft-outbound-request-thread]: Shutdown completed (kafka.raft.RaftSendThread)
[2024-03-16 21:15:12,909] INFO [ProducerStateManager partition=__cluster_metadata-0]Wrote producer snapshot at offset 42204 with 0 producer ids in 17 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2024-03-16 21:15:12,942] INFO [SocketServer listenerType=CONTROLLER, nodeId=2] Stopping socket server request processors (kafka.network.SocketServer)
[2024-03-16 21:15:12,945] INFO [SocketServer listenerType=CONTROLLER, nodeId=2] Stopped socket server request processors (kafka.network.SocketServer)
[2024-03-16 21:15:12,946] INFO [QuorumController id=2] QuorumController#beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2024-03-16 21:15:12,946] INFO [SocketServer listenerType=CONTROLLER, nodeId=2] Shutting down socket server (kafka.network.SocketServer)
[2024-03-16 21:15:12,949] INFO [SocketServer listenerType=CONTROLLER, nodeId=2] Shutdown completed (kafka.network.SocketServer)
[2024-03-16 21:15:12,949] INFO [data-plane Kafka Request Handler on Broker 2], shutting down (kafka.server.KafkaRequestHandlerPool)
[2024-03-16 21:15:12,950] INFO [data-plane Kafka Request Handler on Broker 2], shut down completely (kafka.server.KafkaRequestHandlerPool)
[2024-03-16 21:15:12,950] INFO [ExpirationReaper-2-AlterAcls]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,950] INFO [ExpirationReaper-2-AlterAcls]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,950] INFO [ExpirationReaper-2-AlterAcls]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-03-16 21:15:12,950] INFO [controller-2-ThrottledChannelReaper-Fetch]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-Fetch]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-Fetch]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-Produce]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-Produce]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-Produce]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-Request]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-Request]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-Request]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-ControllerMutation]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-ControllerMutation]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [controller-2-ThrottledChannelReaper-ControllerMutation]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-03-16 21:15:12,951] INFO [QuorumController id=2] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2024-03-16 21:15:12,953] INFO [SharedServer id=2] Stopping SharedServer (kafka.server.SharedServer)
[2024-03-16 21:15:12,953] INFO [MetadataLoader id=2] beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2024-03-16 21:15:12,953] INFO [SnapshotGenerator id=2] close: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2024-03-16 21:15:12,953] INFO [SnapshotGenerator id=2] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2024-03-16 21:15:12,953] INFO [MetadataLoader id=2] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2024-03-16 21:15:12,954] INFO [SnapshotGenerator id=2] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2024-03-16 21:15:12,954] INFO Metrics scheduler closed (org.apache.kafka.common.metrics.Metrics)
[2024-03-16 21:15:12,954] INFO Closing reporter org.apache.kafka.common.metrics.JmxReporter (org.apache.kafka.common.metrics.Metrics)
[2024-03-16 21:15:12,954] INFO Metrics reporters closed (org.apache.kafka.common.metrics.Metrics)
[2024-03-16 21:15:12,955] INFO App info kafka.server for 2 unregistered (org.apache.kafka.common.utils.AppInfoParser)
[2024-03-16 21:15:12,955] INFO App info kafka.server for 2 unregistered (org.apache.kafka.common.utils.AppInfoParser)
