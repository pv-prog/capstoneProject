[2024-03-17 19:14:44,851] INFO [RaftManager id=2] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:14:44,993] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 33803 due to node 3 being disconnected (elapsed time since creation: 991332ms, elapsed time since send: 991332ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:14:44,993] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:44,851] INFO [RaftManager id=1] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:14:45,002] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 28604 due to node 3 being disconnected (elapsed time since creation: 991329ms, elapsed time since send: 991329ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:14:45,006] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, epoch=90, retries=1, voteStates={1=UNRECORDED, 2=GRANTED, 3=UNRECORDED}, highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], electionTimeoutMs=1357) from FollowerState(fetchTimeoutMs=2000, epoch=89, leaderId=3, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:14:45,009] INFO [RaftManager id=1] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,048] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, epoch=90, retries=1, voteStates={1=GRANTED, 2=UNRECORDED, 3=UNRECORDED}, highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], electionTimeoutMs=1856) from FollowerState(fetchTimeoutMs=2000, epoch=89, leaderId=3, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:14:45,067] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=90, candidateId=2, lastOffsetEpoch=89, lastOffset=76065)])]) with epoch 90 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,081] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=90, candidateId=1, lastOffsetEpoch=89, lastOffset=76065)])]) with epoch 90 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,103] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,103] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,103] INFO [RaftManager id=1] Insufficient remaining votes to become leader (rejected by [2, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,103] INFO [RaftManager id=1] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,108] INFO [BrokerToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:14:45,108] INFO [BrokerToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:14:45,112] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, epoch=91, retries=2, voteStates={1=UNRECORDED, 2=GRANTED, 3=UNRECORDED}, highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], electionTimeoutMs=1639) from CandidateState(localId=2, epoch=90, retries=1, voteStates={1=REJECTED, 2=GRANTED, 3=REJECTED}, highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], electionTimeoutMs=1357) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:14:45,117] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, epoch=91, retries=2, voteStates={1=GRANTED, 2=UNRECORDED, 3=UNRECORDED}, highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], electionTimeoutMs=1154) from CandidateState(localId=1, epoch=90, retries=1, voteStates={1=GRANTED, 2=REJECTED, 3=REJECTED}, highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], electionTimeoutMs=1856) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:14:45,117] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=91, candidateId=2, lastOffsetEpoch=89, lastOffset=76065)])]) with epoch 91 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,118] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=91, candidateId=1, lastOffsetEpoch=89, lastOffset=76065)])]) with epoch 91 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,147] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,147] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,147] INFO [RaftManager id=1] Insufficient remaining votes to become leader (rejected by [2, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,153] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, epoch=92, retries=3, voteStates={1=UNRECORDED, 2=GRANTED, 3=UNRECORDED}, highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], electionTimeoutMs=1535) from CandidateState(localId=2, epoch=91, retries=2, voteStates={1=REJECTED, 2=GRANTED, 3=REJECTED}, highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], electionTimeoutMs=1639) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:14:45,165] INFO [RaftManager id=1] Completed transition to Unattached(epoch=92, voters=[1, 2, 3], electionTimeoutMs=1101) from CandidateState(localId=1, epoch=91, retries=2, voteStates={1=GRANTED, 2=REJECTED, 3=REJECTED}, highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], electionTimeoutMs=1154) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:14:45,172] INFO [RaftManager id=1] Completed transition to Voted(epoch=92, votedId=2, voters=[1, 2, 3], electionTimeoutMs=1990) from Unattached(epoch=92, voters=[1, 2, 3], electionTimeoutMs=1101) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:14:45,173] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=92, candidateId=2, lastOffsetEpoch=89, lastOffset=76065)])]) with epoch 92 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:14:45,185] INFO [RaftManager id=2] Completed transition to Leader(localId=2, epoch=92, epochStartOffset=76065, highWatermark=Optional.empty, voterStates={1=ReplicaState(nodeId=1, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(nodeId=2, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(nodeId=3, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, epoch=92, retries=3, voteStates={1=GRANTED, 2=GRANTED, 3=REJECTED}, highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], electionTimeoutMs=1535) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:14:45,209] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:14:45,210] INFO [BrokerToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:14:45,210] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:14:45,248] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=92, leaderId=2, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=76064, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Voted(epoch=92, votedId=2, voters=[1, 2, 3], electionTimeoutMs=1990) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:14:45,261] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:14:45,262] INFO [BrokerToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:14:45,262] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:14:45,312] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:14:45,314] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:14:45,320] INFO [BrokerToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:14:45,320] INFO [BrokerToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:14:45,320] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:14:45,320] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:14:45,353] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=76066, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5394328)]) for the first time for epoch 92 based on indexOfHw 1 and voters [ReplicaState(nodeId=1, endOffset=Optional[LogOffsetMetadata(offset=76066, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5394328)])], lastFetchTimestamp=1710683085353, lastCaughtUpTimestamp=1710683085353, hasAcknowledgedLeader=true), ReplicaState(nodeId=2, endOffset=Optional[LogOffsetMetadata(offset=76066, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5394328)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(nodeId=3, endOffset=Optional[LogOffsetMetadata(offset=76065, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5394222)])], lastFetchTimestamp=1710683085315, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2024-03-17 19:14:45,372] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:14:45,372] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9095 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:19:17,863] INFO [RaftManager id=1] Completed transition to Unattached(epoch=93, voters=[1, 2, 3], electionTimeoutMs=1055) from FollowerState(fetchTimeoutMs=2000, epoch=92, leaderId=2, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=76075, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:17,863] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=93, candidateId=3, lastOffsetEpoch=92, lastOffset=76075)])]) with epoch 93 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:19:17,921] INFO [RaftManager id=2] Completed transition to Unattached(epoch=93, voters=[1, 2, 3], electionTimeoutMs=1332) from Leader(localId=2, epoch=92, epochStartOffset=76065, highWatermark=Optional[LogOffsetMetadata(offset=76076, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395048)])], voterStates={1=ReplicaState(nodeId=1, endOffset=Optional[LogOffsetMetadata(offset=76076, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395048)])], lastFetchTimestamp=1710683357812, lastCaughtUpTimestamp=1710683357812, hasAcknowledgedLeader=true), 2=ReplicaState(nodeId=2, endOffset=Optional[LogOffsetMetadata(offset=76076, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395048)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(nodeId=3, endOffset=Optional[LogOffsetMetadata(offset=76075, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5394976)])], lastFetchTimestamp=1710683357803, lastCaughtUpTimestamp=1710683089954, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:17,922] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=93, candidateId=3, lastOffsetEpoch=92, lastOffset=76075)])]) with epoch 93 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:19:18,016] INFO [RaftManager id=1] Completed transition to Unattached(epoch=94, voters=[1, 2, 3], electionTimeoutMs=947) from Unattached(epoch=93, voters=[1, 2, 3], electionTimeoutMs=1055) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:18,024] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=94, candidateId=3, lastOffsetEpoch=92, lastOffset=76075)])]) with epoch 94 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:19:18,027] INFO [RaftManager id=2] Completed transition to Unattached(epoch=94, voters=[1, 2, 3], electionTimeoutMs=1291) from Unattached(epoch=93, voters=[1, 2, 3], electionTimeoutMs=1332) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:18,029] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=94, candidateId=3, lastOffsetEpoch=92, lastOffset=76075)])]) with epoch 94 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:19:18,220] INFO [RaftManager id=2] Completed transition to Unattached(epoch=95, voters=[1, 2, 3], electionTimeoutMs=1100) from Unattached(epoch=94, voters=[1, 2, 3], electionTimeoutMs=1291) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:18,221] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=95, candidateId=3, lastOffsetEpoch=92, lastOffset=76075)])]) with epoch 95 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:19:18,222] INFO [RaftManager id=1] Completed transition to Unattached(epoch=95, voters=[1, 2, 3], electionTimeoutMs=756) from Unattached(epoch=94, voters=[1, 2, 3], electionTimeoutMs=947) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:18,222] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=95, candidateId=3, lastOffsetEpoch=92, lastOffset=76075)])]) with epoch 95 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:19:18,674] INFO [RaftManager id=2] Completed transition to Unattached(epoch=96, voters=[1, 2, 3], electionTimeoutMs=565) from Unattached(epoch=95, voters=[1, 2, 3], electionTimeoutMs=1100) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:18,680] INFO [RaftManager id=1] Completed transition to Unattached(epoch=96, voters=[1, 2, 3], electionTimeoutMs=222) from Unattached(epoch=95, voters=[1, 2, 3], electionTimeoutMs=756) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:18,681] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=96, candidateId=3, lastOffsetEpoch=92, lastOffset=76075)])]) with epoch 96 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:19:18,682] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=96, candidateId=3, lastOffsetEpoch=92, lastOffset=76075)])]) with epoch 96 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:19:18,738] INFO [BrokerToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:19:18,738] INFO [BrokerToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:19:18,900] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, epoch=97, retries=1, voteStates={1=GRANTED, 2=UNRECORDED, 3=UNRECORDED}, highWatermark=Optional[LogOffsetMetadata(offset=76075, metadata=Optional.empty)], electionTimeoutMs=1483) from Unattached(epoch=96, voters=[1, 2, 3], electionTimeoutMs=222) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:18,921] INFO [RaftManager id=2] Completed transition to Unattached(epoch=97, voters=[1, 2, 3], electionTimeoutMs=325) from Unattached(epoch=96, voters=[1, 2, 3], electionTimeoutMs=565) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:18,943] INFO [RaftManager id=2] Completed transition to Voted(epoch=97, votedId=1, voters=[1, 2, 3], electionTimeoutMs=1868) from Unattached(epoch=97, voters=[1, 2, 3], electionTimeoutMs=325) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:18,943] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=97, candidateId=1, lastOffsetEpoch=92, lastOffset=76076)])]) with epoch 97 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:19:18,962] INFO [RaftManager id=1] Completed transition to Leader(localId=1, epoch=97, epochStartOffset=76076, highWatermark=Optional.empty, voterStates={1=ReplicaState(nodeId=1, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(nodeId=2, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(nodeId=3, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, epoch=97, retries=1, voteStates={1=GRANTED, 2=UNRECORDED, 3=GRANTED}, highWatermark=Optional[LogOffsetMetadata(offset=76075, metadata=Optional.empty)], electionTimeoutMs=1483) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:19,008] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=97, leaderId=1, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=76076, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395048)])], fetchingSnapshot=Optional.empty) from Voted(epoch=97, votedId=1, voters=[1, 2, 3], electionTimeoutMs=1868) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:19:19,029] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=76077, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395154)]) for the first time for epoch 97 based on indexOfHw 1 and voters [ReplicaState(nodeId=1, endOffset=Optional[LogOffsetMetadata(offset=76077, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395154)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(nodeId=2, endOffset=Optional[LogOffsetMetadata(offset=76077, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395154)])], lastFetchTimestamp=1710683359029, lastCaughtUpTimestamp=1710683359029, hasAcknowledgedLeader=true), ReplicaState(nodeId=3, endOffset=Optional[LogOffsetMetadata(offset=76075, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5394976)])], lastFetchTimestamp=1710683359005, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2024-03-17 19:19:19,053] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9093 (id: 1 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:19:19,058] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9093 (id: 1 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:32:00,967] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:32:01,003] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 33827 due to node 1 being disconnected (elapsed time since creation: 756315ms, elapsed time since send: 756315ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:32:01,005] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,226] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, epoch=98, retries=1, voteStates={1=UNRECORDED, 2=GRANTED, 3=UNRECORDED}, highWatermark=Optional[LogOffsetMetadata(offset=76087, metadata=Optional.empty)], electionTimeoutMs=1170) from FollowerState(fetchTimeoutMs=2000, epoch=97, leaderId=1, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=76087, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:32:01,229] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=98, candidateId=3, lastOffsetEpoch=97, lastOffset=76088)])]) with epoch 98 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,356] INFO [RaftManager id=1] Completed transition to Unattached(epoch=98, voters=[1, 2, 3], electionTimeoutMs=1597) from Leader(localId=1, epoch=97, epochStartOffset=76076, highWatermark=Optional[LogOffsetMetadata(offset=76088, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395946)])], voterStates={1=ReplicaState(nodeId=1, endOffset=Optional[LogOffsetMetadata(offset=76089, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5396018)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(nodeId=2, endOffset=Optional[LogOffsetMetadata(offset=76088, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395946)])], lastFetchTimestamp=1710684120966, lastCaughtUpTimestamp=1710683364652, hasAcknowledgedLeader=true), 3=ReplicaState(nodeId=3, endOffset=Optional[LogOffsetMetadata(offset=76088, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395946)])], lastFetchTimestamp=1710684120967, lastCaughtUpTimestamp=1710683364655, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:32:01,356] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=98, candidateId=2, lastOffsetEpoch=97, lastOffset=76088)])]) with epoch 98 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,356] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=98, candidateId=3, lastOffsetEpoch=97, lastOffset=76088)])]) with epoch 98 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,356] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1527970041). (org.apache.kafka.deferred.DeferredEventQueue)
[2024-03-17 19:32:01,356] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(565521112). (org.apache.kafka.deferred.DeferredEventQueue)
[2024-03-17 19:32:01,357] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(69253601). (org.apache.kafka.deferred.DeferredEventQueue)
[2024-03-17 19:32:01,357] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(262429685). (org.apache.kafka.deferred.DeferredEventQueue)
[2024-03-17 19:32:01,357] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,357] INFO [BrokerToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:32:01,357] INFO [BrokerToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:32:01,482] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,570] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, epoch=99, retries=2, voteStates={1=UNRECORDED, 2=GRANTED, 3=UNRECORDED}, highWatermark=Optional[LogOffsetMetadata(offset=76087, metadata=Optional.empty)], electionTimeoutMs=1030) from CandidateState(localId=2, epoch=98, retries=1, voteStates={1=REJECTED, 2=GRANTED, 3=REJECTED}, highWatermark=Optional[LogOffsetMetadata(offset=76087, metadata=Optional.empty)], electionTimeoutMs=1170) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:32:01,570] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=99, candidateId=3, lastOffsetEpoch=97, lastOffset=76088)])]) with epoch 99 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,588] INFO [RaftManager id=1] Completed transition to Unattached(epoch=99, voters=[1, 2, 3], electionTimeoutMs=1317) from Unattached(epoch=98, voters=[1, 2, 3], electionTimeoutMs=1597) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:32:01,588] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=99, candidateId=3, lastOffsetEpoch=97, lastOffset=76088)])]) with epoch 99 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,588] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=99, candidateId=2, lastOffsetEpoch=97, lastOffset=76088)])]) with epoch 99 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,588] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,733] INFO [RaftManager id=1] Completed transition to Unattached(epoch=100, voters=[1, 2, 3], electionTimeoutMs=1126) from Unattached(epoch=99, voters=[1, 2, 3], electionTimeoutMs=1317) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:32:01,733] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=100, candidateId=3, lastOffsetEpoch=97, lastOffset=76088)])]) with epoch 100 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,734] INFO [RaftManager id=2] Completed transition to Unattached(epoch=100, voters=[1, 2, 3], electionTimeoutMs=812) from CandidateState(localId=2, epoch=99, retries=2, voteStates={1=REJECTED, 2=GRANTED, 3=REJECTED}, highWatermark=Optional[LogOffsetMetadata(offset=76087, metadata=Optional.empty)], electionTimeoutMs=1030) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:32:01,761] INFO [RaftManager id=2] Completed transition to Voted(epoch=100, votedId=3, voters=[1, 2, 3], electionTimeoutMs=1191) from Unattached(epoch=100, voters=[1, 2, 3], electionTimeoutMs=812) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:32:01,762] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='KhtXgGqdSyGIG9GbQ_XHfg', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=100, candidateId=3, lastOffsetEpoch=97, lastOffset=76088)])]) with epoch 100 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,832] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=100, leaderId=3, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=76087, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Voted(epoch=100, votedId=3, voters=[1, 2, 3], electionTimeoutMs=1191) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:32:01,851] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=100, leaderId=3, voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=76088, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=5395946)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=100, voters=[1, 2, 3], electionTimeoutMs=1126) (org.apache.kafka.raft.QuorumState)
[2024-03-17 19:32:01,852] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/server-1/kraft-combined-logs] Truncating to offset 76088 (kafka.log.UnifiedLog)
[2024-03-17 19:32:01,857] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/server-1/kraft-combined-logs] Loading producer state till offset 76088 with message format version 2 (kafka.log.UnifiedLog$)
[2024-03-17 19:32:01,857] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/server-1/kraft-combined-logs] Reloading from producer snapshot and rebuilding producer state from offset 76088 (kafka.log.UnifiedLog$)
[2024-03-17 19:32:01,857] INFO [ProducerStateManager partition=__cluster_metadata-0]Loading producer state from snapshot file 'SnapshotFile(offset=47700, file=/tmp/server-1/kraft-combined-logs/__cluster_metadata-0/00000000000000047700.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2024-03-17 19:32:01,875] INFO [ProducerStateManager partition=__cluster_metadata-0]Wrote producer snapshot at offset 76088 with 0 producer ids in 10 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2024-03-17 19:32:01,875] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/server-1/kraft-combined-logs] Producer state recovery took 7ms for snapshot load and 11ms for segment recovery from offset 76088 (kafka.log.UnifiedLog$)
[2024-03-17 19:32:01,875] INFO [RaftManager id=1] Truncated to offset 76088 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2024-03-17 19:32:01,885] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9097 (id: 3 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:32:01,885] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new controller, from now on will use node localhost:9097 (id: 3 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2024-03-17 19:37:07,701] INFO [BrokerToControllerChannelManager id=2 name=forwarding] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:41:55,040] INFO [RaftManager id=1] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:42:01,707] INFO [RaftManager id=2] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-03-17 19:48:31,888] INFO [SnapshotGenerator id=1] Creating new KRaft snapshot file snapshot 00000000000000078055-0000000100 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2024-03-17 19:48:31,920] INFO [SnapshotEmitter id=1] Successfully wrote snapshot 00000000000000078055-0000000100 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2024-03-17 19:48:34,402] INFO [SnapshotGenerator id=2] Creating new KRaft snapshot file snapshot 00000000000000078060-0000000100 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2024-03-17 19:48:34,435] INFO [SnapshotEmitter id=2] Successfully wrote snapshot 00000000000000078060-0000000100 (org.apache.kafka.image.publisher.SnapshotEmitter)
